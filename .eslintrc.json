{
  "extends": ["next/core-web-vitals"],
  "rules": {
    "react-hooks/exhaustive-deps": "warn",
    "react/no-unescaped-entities": "warn",
    "@next/next/no-img-element": "warn",
    "@next/next/no-async-client-component": "warn",
    "react-hooks/rules-of-hooks": "error",

    // üèóÔ∏è ARCHITECTURAL GOVERNANCE RULES
    "no-restricted-imports": [
      "error",
      {
        "patterns": [
          {
            "group": ["@supabase/supabase-js"],
            "importNames": ["createClient"],
            "message": "‚ùå ARCHITECTURAL VIOLATION: Direct createClient usage in components. Use API endpoints instead. See docs/patterns/data-access.md"
          }
        ],
        "paths": [
          {
            "name": "@/lib/supabase",
            "importNames": ["SupabaseService"],
            "message": "‚ùå ARCHITECTURAL VIOLATION: SupabaseService in API routes. Use createRouteHandlerClient instead. See docs/patterns/authentication.md"
          }
        ]
      }
    ],

    "no-restricted-syntax": [
      "error",
      {
        "selector": "CallExpression[callee.type='MemberExpression'][callee.object.name='supabase'][callee.property.name='from']",
        "message": "‚ùå ARCHITECTURAL VIOLATION: Direct database queries in components. Use API endpoints instead. See docs/patterns/data-access.md"
      },
      {
        "selector": "CallExpression[callee.type='MemberExpression'][callee.property.name='auth'] CallExpression[callee.property.name='getUser'] :not([arguments.length=1])",
        "message": "‚ùå ARCHITECTURAL VIOLATION: auth.getUser() without token in API routes. Use createRouteHandlerClient with cookies. See docs/patterns/authentication.md"
      }
    ]
  },

  "overrides": [
    {
      "files": [
        "lib/supabase.ts",
        "lib/admin-supabase.ts",
        "lib/prompt-generator.js",
        "lib/enhanced-prompt-generator.ts",
        "lib/rate-limiter.ts",
        "lib/server-cart-context.tsx",
        "lib/batch-processing-service.ts",
        "lib/data-encryption.ts",
        "lib/api-auth.ts",
        "lib/audit-logger.ts",
        "lib/auth-middleware.ts",
        "lib/auth-server.ts",
        "scripts/**/*"
      ],
      "rules": {
        "no-restricted-imports": "off",
        "no-restricted-syntax": "off",
        "react-hooks/exhaustive-deps": "off"
      }
    },
    {
      "files": ["app/api/**/route.ts", "app/api/**/route.js"],
      "rules": {
        "no-restricted-imports": [
          "error",
          {
            "patterns": [
              {
                "group": ["@supabase/auth-helpers-nextjs"],
                "importNames": ["createClientComponentClient"],
                "message": "‚ùå ARCHITECTURAL VIOLATION: Client auth in server route. Use createRouteHandlerClient. See docs/patterns/authentication.md"
              }
            ]
          }
        ],
        "no-restricted-syntax": "off"
      }
    },
    {
      "files": ["app/admin/**/*.tsx", "app/admin/**/*.js"],
      "rules": {
        "no-restricted-imports": "off",
        "no-restricted-syntax": "off",
        "react-hooks/exhaustive-deps": "off"
      }
    },
    {
      "files": [
        "**/app/customer/pets/PetsClient.tsx",
        "**/app/pets/PetsClient.tsx",
        "**/app/customer/pets/add/page.tsx",
        "**/app/pets/add/page.tsx",
        "**/app/signup/user/page.tsx",
        "**/app/signup/user-qr/page.tsx",
        "**/app/referrals/create/page.tsx",
        "**/app/home/page.tsx"
      ],
      "rules": {
        "no-restricted-imports": "off",
        "no-restricted-syntax": "off"
      }
    },
    {
      "files": ["app/**/page.tsx", "app/**/page.js", "components/**/*.tsx", "components/**/*.js"],
      "excludedFiles": ["app/admin/**/*", "lib/**/*", "scripts/**/*"],
      "rules": {
        "no-restricted-imports": [
          "error",
          {
            "patterns": [
              {
                "group": ["@supabase/supabase-js"],
                "message": "‚ùå ARCHITECTURAL VIOLATION: Direct Supabase client in component. Use API endpoints. See docs/patterns/data-access.md"
              },
              {
                "group": ["@/lib/admin-supabase"],
                "message": "‚ùå ARCHITECTURAL VIOLATION: AdminSupabaseService in non-admin component. Use appropriate API endpoints. See docs/patterns/data-access.md"
              }
            ]
          }
        ]
      }
    }
  ]
}